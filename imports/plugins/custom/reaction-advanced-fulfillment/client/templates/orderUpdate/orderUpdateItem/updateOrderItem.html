<template name='updateOrderItem'>
  {{#with order}}
    <div class='container-fluid'>
      <div class='row'>
        <div class='text-center'>
          <h1>Order Number: {{orderNumber}}</h1>
        </div>
      </div>
      <div class='container'>
        <div class='row'>
          Current Item:
        </div>
        <div class='row'>
          <div class='col-xs-3'>
            <h5>{{item.afItem.itemDescription}}</h5>
          </div>
          <div class='col-xs-2'>
            <h5>{{item.regItem.variants.color}}</h5>
          </div>
          <div class='col-xs-2'>
            <h5>{{item.regItem.variants.size}}</h5>
          </div>
        </div>
      </div>
      <hr>
      <div class='container'>
        <h3>Replace Current item with:</h3>
      </div>
      {{> productSelector}}
    </div>
  {{/with}}
</template>


<template name='productSelector'>
  <select class='form-control productType-selector'>
    <option disabled selected> -- select a product type -- </option>
    {{#each product in productTypes}}
      <option class="form-control" value="{{product.productType}}">{{product.productType}}</option>
    {{/each}}
  </select>
  {{#if productTypeSelected}}
    <select class='form-control gender-selector'>
      <option disabled selected> -- select gender -- </option>
      {{#each product in productGenders}}
        <option class="form-control" value="{{product.gender}}">{{product.gender}}</option>
      {{/each}}
    </select>
  {{/if}}
  {{#if productGenderSelected}}
    <select class='form-control product-selector'>
      <option disabled selected> -- select product -- </option>
      {{#each product in productTitles}}
        <option class="form-control" value="{{product._id}}">{{product.title}}</option>
      {{/each}}
    </select>
  {{/if}}
  {{#if productSelected}}
     <select class='form-control color-selector'>
      <option disabled selected> -- select color -- </option>
      {{#each product in productColorWays}}
        <option class="form-control" data-product-id="{{product._id}}" value="{{product.color}}">{{product.color}}</option>
      {{/each}}
    </select>
  {{/if}}
  {{#if productColorSelected}}
    {{#if availabilityReady}}
       <select class='form-control size-selector'>
        <option disabled selected> -- select size-- </option>
        {{#each product in productSizes}}
          <option class="form-control" value="{{product._id}}" {{isAvailable product._id}}>{{product.size}} (qty: {{quantityAvailable product._id}})</option>
        {{/each}}
      </select>
    {{else}}
      <span><i class="fa fa-spinner fa-spin"></i> Checking Availability</span>
    {{/if}}
  {{/if}}
  {{#if productVariantSelected}}
    {{#if addItem}}
      <button class='btn btn-lg btn-block btn-success add-item' data-bundle-cart-item-id="{{bundle._id}}" data-bundle-id="{{bundle.productId}}" data-order-id="{{order._id}}" data-bundle-index={{bundle.index}}>Add item to Order</button>
    {{else}}
      <button class='btn btn-lg btn-block btn-success replace-item' data-bundle-cart-item-id="{{bundle._id}}" data-bundle-id="{{bundle.productId}}" data-order-id="{{order._id}}" data-item-id='{{item.afItem._id}}'>Exchange Item</button>
    {{/if}}
  {{/if}}
</template>
