<template name='updateOrder'>
  {{> afNavbar}}
  <div class='container-fluid'>
    <div class='row text-center'>
      <div class='col-sm-4 col-md-4 hidden-xs hidden-sm'>
        <h2><a href="{{pathFor route='orderDetails' _id=_id}}"><i class="fa fa-chevron-left"></i> Back to Order</a></h2>
      </div>
      <div class='col-sm-7 col-md-4 col-md-offset-4'>
        <h2>{{{displayOrderNumber this}}}</h2>
      </div>
    </div>
    <div class='row'>
      <div class='table-responsive'>
        <table class='table table-hover'>
          <thead>
            <tr>
              <th></th>
              <th>Description</th>
              <th>Color</th>
              <th>Size</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {{#each item in advancedFulfillment.items}}
              {{#if colorAndSize item}}
                <tr>
                  <td><a class='btn btn-sm btn-warning' href="{{pathFor 'updateOrderItem' orderId=this._id itemId=item._id}}">Edit this Item</a></td>
                  <td>{{item.itemDescription}}</td>
                  <td>{{color item}}</td>
                  <td>{{size item}}</td>
                  <td></td>
                </tr>
              {{else}}
                <tr class='danger'>
                  <td><a class='btn btn-sm btn-danger' href="{{pathFor 'updateOrderItem' orderId=this._id itemId=item._id}}">Edit this Item</a></td>
                  <td>{{item.itemDescription}}</td>
                  <td>
                    <select id='color-selector-{{item._id}}' data-id='{{item._id}}' class='form-control color-selector'>
                      <option disabled selected> -- select a color -- </option>
                      {{#each possibleColor in colorOptions item}}
                        <option class="form-control" value="{{possibleColor}}">{{possibleColor}}</option>
                      {{/each}}
                    </select>
                  </td>
                  <td>
                    {{#if readyToSelectSize item}}
                      <select id='size-selector-{{item._id}}' data-id='{{item._id}}' class='form-control size-selector'>
                        <option disabled selected> -- select a size -- </option>
                        {{#each possibleSize in sizeOptions item}}
                        <option class='form-control' value={{possibleSize._id}}>{{possibleSize.size}}</option>
                        {{/each}}
                      </select>
                    {{/if}}
                  </td>
                  <td>
                    {{#if sizeAndColorSelected item}}
                      <a class='btn btn-success save-item' data-id='{{item._id}}' data-product-id='{{item.productId}}' href='#'>Save</a>
                    {{/if}}
                  </td>
                </tr>
              {{/if}}
            {{/each}}
          </tbody>
        </table>
      </div>
    </div>
    <hr>
    <div class='container'>
      <div class='row text-center'>
        <div class="col-md-8 hidden-xs hidden-sm">
          <h3>Change Order Dates</h3>
        </div>
        <div class="col-md-4 hidden-xs hidden-sm">
          <h3>Add Items</h3>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-12 col-md-4">
          <div class='picker' id='{{_id}}'>
            <div class='input-daterange input-group' id='datepicker'>
              <input type='text' class='input-lg form-control' name='start' placeholder="First Ski Day" value={{formatInputDate startTime}} />
              <span class='input-group-addon'>to</span>
              <input type='text' class='input-lg form-control' name='end' placeholder="Last Ski Day" value={{formatInputDate endTime}} />
            </div>
          </div>
        </div>
        <div class="col-xs-12 col-md-4">
          <button class='btn btn-lg btn-primary update-rental-dates'>Update First/Last Ski Date</button>
        </div>
        <div class="col-xs-12 col-md-4 text-center">
          <a class='btn btn-lg btn-success add-new-item' href='#'>Add an item to this order</a>
        </div>
      </div>
      
    </div>
    <div class='row item-selector'>
    {{#if addingItems}}
      {{> productSelector}}
    {{/if}}
    </div>
  </div>
</template>
